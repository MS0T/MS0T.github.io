<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by Youssef Raafat
  Free for personal and commercial use under the MIT license
  https://github.com/YoussefRaafatNasry/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Serialport Access with Electron">
  <meta property="og:description" content="My journey in developing a small desktop application in Electron. This project is meant to be a lightweight serialport console, which can easily be modified ...">

  <title>Serialport Access with Electron</title>
  <meta name="description" content="My journey in developing a small desktop application in Electron. This project is meant to be a lightweight serialport console, which can easily be modified ...">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>

<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>Maxwell Sotnick</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link " href="/projects/">Projects</a>

      <a class="nav-item nav-link active" href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 post">
  <h1><b>Serialport Access with Electron</b></h1>

<p class="post-metadata text-muted">
  21 May 2021 -  
  <b>25 mins read time</b>

  <br>Tags: 
    
    <a class="text-decoration-none no-underline" href="/blog/tags#electron">
      <span class="tag badge badge-pill text-primary border border-primary">Electron</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#javascript">
      <span class="tag badge badge-pill text-primary border border-primary">JavaScript</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#desktop-application">
      <span class="tag badge badge-pill text-primary border border-primary">Desktop Application</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#node-js">
      <span class="tag badge badge-pill text-primary border border-primary">Node.js</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#uart">
      <span class="tag badge badge-pill text-primary border border-primary">UART</span>
    </a>
    </p>

<style>
#attribution{
    visibility: hidden;
}    

.text-muted {
    visibility: hidden;
}
</style>

<p>This blog post is meant to document the process of developing an application using Electron. I won’t delve too deep into the logistics of how Electron works, however I’ll include some resources that I found useful below. The structure of this post will be a mix of tutorial and insight.</p>

<p>Electron: <a href="https://www.electronjs.org/docs/tutorial/quick-start#main-and-renderer-processes">Quick Start Guide</a></p>

<p>Node Serialport: <a href="https://www.npmjs.com/package/serialport-builds-electron">Serialport Docs</a></p>

<p>MBED PC-USB: <a href="https://os.mbed.com/docs/mbed-os/v6.10/program-setup/serial-communication.html">Board to PC communication over USB</a></p>

<p>Steven Lambert: <a href="https://stevenklambert.com/writing/comprehensive-guide-building-packaging-electron-app/">Packaging Electron</a></p>

<p>Gustavo Machado: <a href="https://medium.com/@machadogj/arduino-and-node-js-via-serial-port-bcf9691fab6a">Node.js via Serialport</a></p>

<h2 id="the-setup">The Setup</h2>

<p>It goes with out saying—verify that you have <a href="https://nodejs.org/en/">Node.js</a> on your machine. From here, we have a few options as to how we want to start our project:</p>

<h3 id="build-project-directory">Build Project Directory</h3>

<ol>
  <li>Build Electron project from scratch</li>
</ol>

<pre><code class="language-cli"># Create and go to repository
$ mkdir &lt;project-name&gt; &amp;&amp; cd &lt;project-name&gt;
# Install the dependencies and run to verify proper setup
$ npm install &amp;&amp; npm start
</code></pre>

<ol>
  <li>Clone a prebuilt Electron repo</li>
</ol>

<pre><code class="language-cli"># Clone the Quick Start repository or the Serialport repository
$ git clone https://github.com/electron/electron-quick-start or https://github.com/serialport/electron-serialport.git
# Go into the repository
$ cd electron-quick-start or electron-serialport
# Install the dependencies and run to verify proper setup
$ npm install &amp;&amp; npm start
</code></pre>

<p>If this is your first time developing an electron application I recommend trying to build it from scratch since I think you’ll get a lot out of having to set up the renderer(s) and main processes. As for this project, I found that the serialport library can be a little finicky in its installation and linking, so you can either follow the setup below verbatim or clone the pre-configured <a href="https://github.com/serialport/electron-serialport">electron-serialport</a> repo.</p>

<h3 id="install-serialport">Install Serialport</h3>

<p>Given that you have not cloned the electron-serialport repo, install the serial port library.</p>

<pre><code class="language-cli"># Install the serialport library as a dependency
$ npm install --save serialport
</code></pre>

<p>You’ll notice that a <code class="highlighter-rouge">node_modules</code> dir will appear, with serialport within. If you compiled with a different version of npm previously, you may need to rebuild the library using a tool such as electron-rebuild. I personally recommend doing this as when I first installed the serialport library, rebuilding the project is what linked the directory correctly.</p>

<pre><code class="language-cli"># Install the electron-rebuild library as a developer dependency
$ npm install --save-dev electron-rebuild
# Run electron-rebuild in just the root directory of the project
$ ./node_modules/.bin/electron-rebuild
$ npm rebuild
</code></pre>

<p>To quickly verify that the serialport library was properly installed and linked, create a new javascript file with the following program and run it with node:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">sp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"serialport"</span><span class="p">);</span>

<span class="nx">sp</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">ports</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ports</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="configure-mainjs--preloadjs">Configure main.js &amp; preload.js</h3>

<p>Finally, we have to specify the entry point into the application (main.js) which will control the application lifecycle, renderer(s), and native OS interactions. Also, we are going to want to define a preload script (preload.js) which will bridge both Node.js and our application.</p>

<p>We’ll start with main.js:</p>

<p>First we are going to import the modules that we will be using to run our application. The <code class="highlighter-rouge">app</code> and <code class="highlighter-rouge">BrowserWindow</code> modules of the electron package allow us to manage the runtime of renderer processes and control the application lifecycle. <code class="highlighter-rouge">path</code> provides utility functions for file paths, while <code class="highlighter-rouge">url</code> provides utilities for URL resolution and parsing.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">electron</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"electron"</span><span class="p">);</span>
<span class="c1">// Module to control application life.</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">electron</span><span class="p">.</span><span class="nx">app</span><span class="p">;</span>
<span class="c1">// Module to create native browser window.</span>
<span class="kd">const</span> <span class="nx">BrowserWindow</span> <span class="o">=</span> <span class="nx">electron</span><span class="p">.</span><span class="nx">BrowserWindow</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"path"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"url"</span><span class="p">);</span>
</code></pre></div></div>

<p>The following is a fairly standard setup for window creation—to which there are many different ways to implement. Several things to note:</p>

<ol>
  <li>
    <p>The main application window of our program is created, with our preload.js having run in this process. Then the renderer (index.js in our case) is loaded into that primed window.</p>
  </li>
  <li>
    <p>DevTools are currently disabled, however by un-commenting <code class="highlighter-rouge">mainWindow.webContents.openDevTools()</code> you can more effectively and efficiently edit the html and css of your renderer process(es).</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">app.allowRendererProcessReuse=false</code> is a must in order to load the serialport library into the renderer process. It has been marked as a deprecated flag on the Github Issues page, however it still appears to be necessary in some builds.</p>
  </li>
  <li>
    <p>Presented are two ways of quitting the app: the first, which is commented, is the standard for ending application processes in MacOS—application remains active until explicitly terminated with Cmd-Q; the second, which is not commented, terminates the application once all windows are closed. Since this application is quite small and lacks many background processes, I elected to use the latter of the two conventions.</p>
  </li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Keep a global reference of the window object, if you don't, the window will</span>
<span class="c1">// be closed automatically when the JavaScript object is garbage collected.</span>
<span class="kd">let</span> <span class="nx">mainWindow</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">createWindow</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Create the browser window.</span>
  <span class="nx">mainWindow</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BrowserWindow</span><span class="p">({</span>
    <span class="na">width</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
    <span class="na">height</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
    <span class="na">webPreferences</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">nodeIntegration</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">preload</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">"preload.js"</span><span class="p">),</span>
    <span class="p">},</span>
  <span class="p">});</span>

  <span class="c1">// and load the index.html of the app.</span>
  <span class="nx">mainWindow</span><span class="p">.</span><span class="nx">loadURL</span><span class="p">(</span>
    <span class="nx">url</span><span class="p">.</span><span class="nx">format</span><span class="p">({</span>
      <span class="na">pathname</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">"index.html"</span><span class="p">),</span>
      <span class="na">protocol</span><span class="p">:</span> <span class="s2">"file:"</span><span class="p">,</span>
      <span class="na">slashes</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">})</span>
  <span class="p">);</span>

  <span class="c1">// Open the DevTools.</span>
  <span class="c1">//mainWindow.webContents.openDevTools()</span>

  <span class="c1">// Emitted when the window is closed.</span>
  <span class="nx">mainWindow</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"closed"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Dereference the window object, usually you would store windows</span>
    <span class="c1">// in an array if your app supports multi windows, this is the time</span>
    <span class="c1">// when you should delete the corresponding element.</span>
    <span class="nx">mainWindow</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="c1">// This is required to be set to false beginning in Electron v9 otherwise</span>
<span class="c1">// the SerialPort module can not be loaded in Renderer processes like we are doing</span>
<span class="c1">// in this example. The linked Github issues says this will be deprecated starting in v10,</span>
<span class="c1">// however it appears to still be changed and working in v11.2.0</span>
<span class="c1">// Relevant discussion: https://github.com/electron/electron/issues/18397</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">allowRendererProcessReuse</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

<span class="c1">// This method will be called when Electron has finished</span>
<span class="c1">// initialization and is ready to create browser windows.</span>
<span class="c1">// Some APIs can only be used after this event occurs.</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"ready"</span><span class="p">,</span> <span class="nx">createWindow</span><span class="p">);</span>

<span class="c1">// Quit Options:</span>
<span class="c1">// Quit when all windows are closed.</span>
<span class="c1">// app.on('window-all-closed', function() {</span>
<span class="c1">//     // On OS X it is common for applications and their menu bar</span>
<span class="c1">//     // to stay active until the user quits explicitly with Cmd + Q</span>
<span class="c1">//     app.quit()</span>
<span class="c1">// })</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span>
  <span class="s2">"window-all-closed"</span><span class="p">,</span>
  <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">process</span><span class="p">.</span><span class="nx">platform</span> <span class="o">!==</span> <span class="s2">"darwin"</span> <span class="o">&amp;&amp;</span> <span class="nx">app</span><span class="p">.</span><span class="nx">quit</span><span class="p">()</span> <span class="c1">// "darwin" targets macOS only.</span>
<span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"activate"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// On OS X it's common to re-create a window in the app when the</span>
  <span class="c1">// dock icon is clicked and there are no other windows open.</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">mainWindow</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">createWindow</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// In this file you can include the rest of your app's specific main process</span>
<span class="c1">// code. You can also put them in separate files and require them here.</span>
</code></pre></div></div>

<p>Finally, we can move on to configuring preload.js:</p>

<p>The goal with the preload script is to simply grant access to additional Node.js APIs by exposing them from your preload script. In our case this means linking the import statement from the renderer process to the serialnode library in <code class="highlighter-rouge">node_modules</code>.</p>

<p>Note: Electron utilizes chromium to display web content (ie the window in which our application lives)</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// All of the Node.js APIs are available in the preload process.</span>
<span class="c1">// It has the same sandbox as a Chrome extension.</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"DOMContentLoaded"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">type</span> <span class="k">of</span> <span class="p">[</span><span class="s2">"chrome"</span><span class="p">,</span> <span class="s2">"node"</span><span class="p">,</span> <span class="s2">"electron"</span><span class="p">])</span> <span class="p">{</span>
    <span class="nx">replaceText</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">type</span><span class="p">}</span><span class="s2">-version`</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">versions</span><span class="p">[</span><span class="nx">type</span><span class="p">]);</span>
  <span class="p">}</span>

  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"serialport-version"</span><span class="p">).</span><span class="nx">innerText</span> <span class="o">=</span>
    <span class="nx">require</span><span class="p">(</span><span class="s2">"serialport/package"</span><span class="p">).</span><span class="nx">version</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="create-renderer-process">Create renderer process</h2>

<p>Now that we have our project fully setup, it’s time to write the renderer process of our project. This means dumping our desired html and css into a .html file (in our case we’ll call this index.html). We’ll also want to include some javascript so that our application has further functionality other than looking pretty. However, before delving into the javascript, lets design how the application will look.</p>

<h3 id="design-and-modify-indexhtml">Design and modify index.html</h3>

<p>As stated above, we will begin by designing the look and feel of our application first, such that when we begin writing the javascript there will be “physical” representations of what we are designing functionality for.</p>

<p>The below html is the body of my application and includes all of the widgets and inputs needed to communicate/interface with the connected serialport devices. Here is the feature list I devised prior to development:</p>

<ul>
  <li>
    <p>Incoming &amp; Outgoing data log</p>
  </li>
  <li>
    <p>Outgoing data input</p>
  </li>
  <li>
    <p>Auto-scrolling for data log</p>
  </li>
  <li>
    <p>Clear button for the data log</p>
  </li>
  <li>
    <p>Port list for all serialport devices currently connected to the computer</p>
  </li>
  <li>
    <p>Refresh button the port list</p>
  </li>
  <li>
    <p>Baud rate list</p>
  </li>
  <li>
    <p>Connect button the port and baud rate lists</p>
  </li>
  <li>
    <p>Dark/Light mode</p>
  </li>
</ul>

<p>Given the features above, I wrote the html and css below to reflect the desired functionality:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;title&gt;</span>SerialPort Console<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;style&gt;</span>
      <span class="nt">table</span> <span class="p">{</span>
        <span class="nl">border-collapse</span><span class="p">:</span> <span class="nb">collapse</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nt">table</span><span class="o">,</span>
      <span class="nt">th</span><span class="o">,</span>
      <span class="nt">td</span> <span class="p">{</span>
        <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">black</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nc">.btn-circle</span> <span class="p">{</span>
        <span class="nl">width</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span>
        <span class="nl">height</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span>
        <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
        <span class="nl">padding</span><span class="p">:</span> <span class="m">6px</span> <span class="m">0</span><span class="p">;</span>
        <span class="nl">font-size</span><span class="p">:</span> <span class="m">12px</span><span class="p">;</span>
        <span class="nl">line-height</span><span class="p">:</span> <span class="m">1.428571429</span><span class="p">;</span>
        <span class="nl">border-radius</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span>
        <span class="nl">background-color</span><span class="p">:</span> <span class="nb">transparent</span><span class="p">;</span>
        <span class="nl">border-color</span><span class="p">:</span> <span class="nb">transparent</span><span class="p">;</span>
        <span class="nl">margin-left</span><span class="p">:</span> <span class="m">5em</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="nt">&lt;/style&gt;</span>
  <span class="nt">&lt;/head&gt;</span>

  <span class="nt">&lt;body</span> <span class="na">id=</span><span class="s">"body"</span> <span class="na">style=</span><span class="s">"background-color:white"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1</span>
      <span class="na">id=</span><span class="s">"title"</span>
      <span class="na">style=</span><span class="s">"text-align: center;display: inline-block;padding-left: 4em;"</span>
    <span class="nt">&gt;</span>
      Serial Terminal
    <span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"Dbutton"</span> <span class="na">name=</span><span class="s">"light"</span> <span class="na">class=</span><span class="s">"btn btn-default btn-circle"</span><span class="nt">&gt;</span>
      🌙
    <span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;textarea</span>
      <span class="na">rows=</span><span class="s">"30"</span>
      <span class="na">cols=</span><span class="s">"50"</span>
      <span class="na">id=</span><span class="s">"incomingData"</span>
      <span class="na">style=</span><span class="s">"margin-left: 2em;"</span>
    <span class="nt">&gt;&lt;/textarea&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;textarea</span>
      <span class="na">rows=</span><span class="s">"1"</span>
      <span class="na">cols=</span><span class="s">"50"</span>
      <span class="na">id=</span><span class="s">"inputText"</span>
      <span class="na">style=</span><span class="s">"margin-left: 2em;"</span>
    <span class="nt">&gt;&lt;/textarea&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span>
      <span class="na">id=</span><span class="s">"Cbutton"</span>
      <span class="na">type=</span><span class="s">"submit"</span>
      <span class="na">name=</span><span class="s">"button"</span>
      <span class="na">value=</span><span class="s">"Clear"</span>
      <span class="na">style=</span><span class="s">"margin-left: 2em;"</span>
    <span class="nt">/&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"error"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"ports"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">"thelist"</span><span class="nt">&gt;&lt;/ul&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">id=</span><span class="s">"pllbl"</span> <span class="na">for=</span><span class="s">"portlist"</span> <span class="na">style=</span><span class="s">"margin-left: 1.7em;"</span>
      <span class="nt">&gt;</span>Serial Port:<span class="nt">&lt;/label</span>
    <span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">id=</span><span class="s">"brlbl"</span> <span class="na">for=</span><span class="s">"baudrates"</span> <span class="na">style=</span><span class="s">"margin-left: 9.6em;"</span>
      <span class="nt">&gt;</span>Baud Rate (bps):<span class="nt">&lt;/label</span>
    <span class="nt">&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"portlist"</span> <span class="na">style=</span><span class="s">"margin-left: 2em; width: 15em;"</span><span class="nt">&gt;&lt;/select&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"baudrates"</span> <span class="na">style=</span><span class="s">"margin-left: 2em;"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1200"</span><span class="nt">&gt;</span>1200<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2400"</span><span class="nt">&gt;</span>2400<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"4800"</span><span class="nt">&gt;</span>4800<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"9600"</span><span class="nt">&gt;</span>9600<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"19200"</span><span class="nt">&gt;</span>19200<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"57600"</span><span class="nt">&gt;</span>57600<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"115200"</span><span class="nt">&gt;</span>115200<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span>
      <span class="na">id=</span><span class="s">"Sbutton"</span>
      <span class="na">type=</span><span class="s">"submit"</span>
      <span class="na">name=</span><span class="s">"button"</span>
      <span class="na">value=</span><span class="s">"Connect"</span>
      <span class="na">style=</span><span class="s">"margin-left: 2em;"</span>
    <span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"Ubutton"</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"button"</span> <span class="na">value=</span><span class="s">"Update"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>Following this, we want to require the require that our javascript file runs alongside our html in the renderer process. To do so we can simply include the following at the end of our <code class="highlighter-rouge">&lt;body&gt;</code> in index.html :</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
  <span class="nx">require</span><span class="p">(</span><span class="s2">"./renderer.js"</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>From here we are ready to flesh out the functionality of our application.</p>

<h3 id="fun-with-rendererjs">Fun with renderer.js</h3>

<p>Now we can get to the fun part of our project: writing the script to interact with the serialport library. Lets first begin by importing the required libraries, initializing a few global variables for later down the line, and writing an asynchronous function to retrieve the connected serial port devices.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">serialport</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"serialport"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">Readline</span> <span class="o">=</span> <span class="nx">serialport</span><span class="p">.</span><span class="nx">parsers</span><span class="p">.</span><span class="nx">Readline</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">opSys</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">platform</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">selectedPort</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">bd</span> <span class="o">=</span> <span class="mi">9600</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">sp</span><span class="p">;</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">listSerialPorts</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">await</span> <span class="nx">serialport</span><span class="p">.</span><span class="nx">list</span><span class="p">().</span><span class="nx">then</span><span class="p">((</span><span class="nx">ports</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"error"</span><span class="p">).</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"error"</span><span class="p">).</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"ports"</span><span class="p">,</span> <span class="nx">ports</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">ports</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"error"</span><span class="p">).</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s2">"No ports discovered"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">ports</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">port</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">addelement</span><span class="p">(</span><span class="nx">port</span><span class="p">.</span><span class="nx">path</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">addelement</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">completelist</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"portlist"</span><span class="p">);</span>
  <span class="nx">completelist</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">+=</span>
    <span class="s1">'&lt;option value="'</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">'"&gt;'</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">"&lt;/option&gt;"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We first begin by importing the serialport library in as <code class="highlighter-rouge">const serialport</code> so that we can access the various functions provided in the library. From there we initialize the readline parser for the serial ports as <code class="highlighter-rouge">const Readline</code>—this will be used as a delimiter for the incoming data, constraining the amount text read in any given package. From there we define the operating system that is currently running the application—this is important for later on when we try to communicate with a selected device. Also, we declare several variables used to store the current serial connection information, such as name and baud rate.</p>

<p>As part of our system to update the port list with currently connected serial devices, I have written a small function which grabs the current serialport list and parses the elements. Below the <code class="highlighter-rouge">listSerialPorts()</code> function is a helper function that adds an input string to the port list element of index.html.</p>

<p>Now that we have our functions to grab and list all available serial ports, we will write the update button functionality so that we can manually reset the serial port list elements.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"Ubutton"</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">completelist</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"portlist"</span><span class="p">);</span>
  <span class="nx">completelist</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
  <span class="nx">listSerialPorts</span><span class="p">();</span>
<span class="p">};</span>
</code></pre></div></div>

<p>From here we can complete the port connection scheme by writing the script for the connection button. The goal is to collect all of the information needed to initialize and communicate with the port. Since the serialport library is doing most of the heavy lifting we can simply write the following:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"Sbutton"</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">selectElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"#portlist"</span><span class="p">);</span>
  <span class="nx">selectedPort</span> <span class="o">=</span> <span class="nx">selectElement</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">strcmp</span><span class="p">(</span><span class="nx">opSys</span><span class="p">,</span> <span class="s2">"win32"</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">selectedPort</span> <span class="o">=</span> <span class="nx">selectedPort</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
    <span class="nx">selectedPort</span> <span class="o">=</span> <span class="s2">"/dev/cu"</span> <span class="o">+</span> <span class="nx">selectedPort</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">bd</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"#baudrates"</span><span class="p">).</span><span class="nx">value</span><span class="p">);</span>

  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"incomingData"</span><span class="p">).</span><span class="nx">value</span> <span class="o">+=</span>
    <span class="s2">"</span><span class="err">\</span><span class="s2">nPort Connected: "</span> <span class="o">+</span> <span class="nx">selectedPort</span><span class="p">;</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"incomingData"</span><span class="p">).</span><span class="nx">value</span> <span class="o">+=</span> <span class="s2">"</span><span class="err">\</span><span class="s2">nBaud Rate: "</span> <span class="o">+</span> <span class="nx">bd</span> <span class="o">+</span> <span class="s2">"</span><span class="err">\</span><span class="s2">n"</span><span class="p">;</span>

  <span class="nx">sp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">serialPort</span><span class="p">(</span><span class="nx">selectedPort</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">baudRate</span><span class="p">:</span> <span class="nx">bd</span><span class="p">,</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">parser</span> <span class="o">=</span> <span class="nx">sp</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="k">new</span> <span class="nx">Readline</span><span class="p">({</span> <span class="na">delimiter</span><span class="p">:</span> <span class="s2">"</span><span class="err">\</span><span class="s2">r</span><span class="err">\</span><span class="s2">n"</span> <span class="p">}));</span>
  <span class="nx">parser</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"data"</span><span class="p">,</span> <span class="nx">addText</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">onkeypress</span> <span class="o">=</span> <span class="nx">keyPressFunction</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">strcmp</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The first action we take upon clicking the button is grabbing the selected portlist item. Given the operating system, we may need to change the serial port pathname in order to send data to the selected device. This is not an issue on windows, however in Unix and Linux environments each serial communication port has two parts to it, a <code class="highlighter-rouge">tty.*</code> and a <code class="highlighter-rouge">cu.*</code>. The difference between the two is that a TTY device is used to call into a device/system, and the CU device is used to call out of a device/system. Given that the os is Linux/Unix based, we simply cut and add the desired /dev entry.</p>

<p>Once we’ve established the serial port that we will be connecting to, we grab the selected baud rate. With both the serial port and baud rate we can finally create a serial port object and a parser for incoming data. From there we can tie the parser to our addText function, displaying data read from the serial port in the incomingData textarea.</p>

<p>Having written what’s needed to connect to a desired serialport, we will now write the functions responsible for reading and writing data from and to the connected device.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//append incoming data to the textarea.</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">addText</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"incomingData"</span><span class="p">).</span><span class="nx">value</span> <span class="o">+=</span> <span class="s2">"</span><span class="err">\</span><span class="s2">n"</span> <span class="o">+</span> <span class="nx">event</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">textarea</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"incomingData"</span><span class="p">);</span>
  <span class="nx">textarea</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">textarea</span><span class="p">.</span><span class="nx">scrollHeight</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">writeonSer</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//Write the data to serial port.</span>
  <span class="nx">sp</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Error on write: "</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"message written"</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">keyPressFunction</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">charCode</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="o">==</span> <span class="s2">"number"</span> <span class="p">?</span> <span class="nx">e</span><span class="p">.</span><span class="nx">which</span> <span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">charCode</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">writeonSer</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"inputText"</span><span class="p">).</span><span class="nx">value</span> <span class="o">+</span> <span class="s2">"</span><span class="err">\</span><span class="s2">r"</span><span class="p">);</span> <span class="c1">//  + "\r\n"</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"inputText"</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The addText function is relatively straightforward, with the only notable feature being that we update the incomingData textarea so that the latest data read is always on screen. As for the writeonSer function, we are simply leveraging the serialport library’s write function, catching any errors and printing them to a local terminal. The writeonSer function is called when the user presses the “enter” key in the inputText textarea.</p>

<p>Finally, we define the onclick functionality of the dark/light theme button. These functions simply modify the inline css of our index.html file.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"Cbutton"</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"incomingData"</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="p">};</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"Dbutton"</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"Dbutton"</span><span class="p">).</span><span class="nx">name</span> <span class="o">==</span> <span class="s2">"light"</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"Dbutton"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">"🌞"</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"Dbutton"</span><span class="p">).</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">"dark"</span><span class="p">;</span>
        <span class="nx">darkMode</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"Dbutton"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">"🌙"</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"Dbutton"</span><span class="p">).</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">"light"</span><span class="p">;</span>
        <span class="nx">lightMode</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">darkMode</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"body"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s2">"#343a40"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"title"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"pllbl"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"brlbl"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"incomingData"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s2">"#dbe9f4"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"inputText"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s2">"#dbe9f4"</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">lightMode</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"body"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"title"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"pllbl"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"brlbl"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"incomingData"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"inputText"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<figure class="figure w-100">
  <img src="/images/Blog-SerialPort-img1.png" class="figure-img img-fluid rounded" alt="" /></figure>

<h2 id="write-test-script-for-serial-device">Write test script for serial device</h2>

<p>Given that we’ve been testing the functionality of our application throughout development, we should finished with everything we sought out to implement. From here we should test our application with an actual use case—I have elected to write a simple arduino script.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">char</span> <span class="n">receivedChar</span><span class="p">;</span>
<span class="n">bool</span> <span class="n">newData</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">readChar</span><span class="p">();</span>
<span class="kt">void</span> <span class="n">writeData</span><span class="p">();</span> 

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"~Arduino connected~"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">readChar</span><span class="p">();</span>
    <span class="n">writeData</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">readChar</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">available</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">receivedChar</span> <span class="o">=</span> <span class="n">Serial</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
        <span class="n">newData</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">writeData</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">newData</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Echo ... "</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">receivedChar</span><span class="p">);</span>
        <span class="n">newData</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<figure class="figure w-100">
  <img src="/images/Blog-SerialPort-img3.png" class="figure-img img-fluid rounded" alt="" /></figure>

<p>This script simply reads in a single char and echoes it back to the application. The goal of this test is to simply prove the functionality of the application, however it should be fairly evident how it can be modified for reading/writing full strings of text.</p>

<h2 id="build-and-package-for-distribution">Build and package for distribution</h2>

<p>Now that we have design, implemented, and tested our application we can finally build and package it. For this project we will be using electron-forge to handle packaging.</p>

<p>First we will need to install Wine, which is a program that lets non-Windows operating systems run Windows software. Since Electron packaging tools will use Windows APIs to build the Windows package, we will want to install this program—a tutorial can be found here <a href="https://github.com/Gcenx/wine-on-mac">how to install Wine on Mac</a>.</p>

<p>Once we have Wine up and running, we should install electron-forge into our project:</p>

<pre><code class="language-cli"># First install electron-forge using npm
$ npm install --save-dev @electron-forge/cli
# Then import the package to configure electron-forge
$ npx electron-forge import
</code></pre>

<p>At this point you should verify that the import was successful by checking the package.json file. The import should have added a whole config section to the .json file, which defines how the application will be packaged. Once set up, you can run <code class="highlighter-rouge">npm run make</code> to build a Mac package and a zip file containing the Mac package of your app, assuming that you are on a Mac. This will not build a Windows and/or Linux package. If you are having difficulties with electron-forge, I have also had some success with electron-packager.</p>

<p>You will also want to create some icon art and include that in a separate assets directory in order to be packaged alongside the rest of the application. Here is a quick icon that I put to together for my application:</p>

<figure class="figure w-100">
  <img src="/images/Blog-SerialPort-icon.png" class="figure-img img-fluid rounded" alt="" /></figure>

<p>Each platform uses a different extension for the icon: .icns for Mac, .ico for Windows, and .png for Linux.</p>

<p>Thank you for reading this small venture of mine. I hope you found an inkling of it useful whether it be in a current or future project.</p>



</div>
  </main>

  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>Maxwell Sotnick</strong>
  </small>

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="mailto:max.sotnick@gmail.com"
       style="color: #6c757d"
       onMouseOver="this.style.color='#db4437'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.linkedin.com/in/maxwell-sotnick"
       style="color: #6c757d"
       onMouseOver="this.style.color='#007bb5'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a>

</div><small id="attribution">
    theme <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a>
  </small>
  
</footer>

  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>


</body>

</html>